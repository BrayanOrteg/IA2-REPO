# ğŸ”„ Diagramas de Flujo - Backend QuickTask

Diagramas de secuencia y flujo de los procesos principales implementados.

---

## ğŸ“‹ 1. Flujo de Registro de Usuario (RF1)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client â”‚          â”‚ FastAPI  â”‚         â”‚   auth   â”‚        â”‚ Database â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚ POST /auth/registerâ”‚                    â”‚                   â”‚
    â”‚  email, password   â”‚                    â”‚                   â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚                    â”‚ Validate schema    â”‚                   â”‚
    â”‚                    â”‚ (Pydantic)         â”‚                   â”‚
    â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                   â”‚
    â”‚                    â”‚            â”‚       â”‚                   â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚                    â”‚ Check if email     â”‚                   â”‚
    â”‚                    â”‚ exists             â”‚                   â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚                    â”‚     Query User    â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                    â”‚  User exists?      â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚  âŒ 400 Error      â”‚                    â”‚                   â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ if email exists    â”‚                   â”‚
    â”‚  "Email already    â”‚                    â”‚                   â”‚
    â”‚   registered"      â”‚                    â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚                    â”‚ hash_password()    â”‚                   â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
    â”‚                    â”‚  password_hash     â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚                    â”‚ create_user()      â”‚                   â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚                    â”‚   INSERT User     â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                    â”‚  new_user          â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚  âœ… 201 Created    â”‚                    â”‚                   â”‚
    â”‚  {id, email,       â”‚                    â”‚                   â”‚
    â”‚   created_at}      â”‚                    â”‚                   â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
```

---

## ğŸ” 2. Flujo de AutenticaciÃ³n (Login) (RF2)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client â”‚          â”‚ FastAPI  â”‚         â”‚   auth   â”‚        â”‚ Database â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚ POST /auth/login   â”‚                    â”‚                   â”‚
    â”‚  email, password   â”‚                    â”‚                   â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚                    â”‚ authenticate_user()â”‚                   â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚                    â”‚                    â”‚ Get user by email â”‚
    â”‚                    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚                    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                    â”‚                    â”‚  User object      â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚                    â”‚                    â”‚ verify_password() â”‚
    â”‚                    â”‚                    â”‚  (bcrypt)         â”‚
    â”‚                    â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
    â”‚                    â”‚                    â”‚        â”‚          â”‚
    â”‚                    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
    â”‚                    â”‚                    â”‚  match?           â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚  âŒ 401 Unauthorizedâ”‚                   â”‚                   â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
    â”‚  if password wrong â”‚                    â”‚  No match         â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
    â”‚                    â”‚  User object       â”‚  Match âœ…         â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚                    â”‚ create_access_tokenâ”‚                   â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
    â”‚                    â”‚  {"sub": user_id}  â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
    â”‚                    â”‚  JWT token         â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
    â”‚  âœ… 200 OK         â”‚                    â”‚                   â”‚
    â”‚  {access_token,    â”‚                    â”‚                   â”‚
    â”‚   token_type}      â”‚                    â”‚                   â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                   â”‚
    â”‚                    â”‚                    â”‚                   â”‚
```

---

## ğŸ“ 3. Flujo de Crear Tarea (RF4)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client â”‚          â”‚ FastAPI  â”‚    â”‚   auth   â”‚   â”‚ crud â”‚    â”‚ Database â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚                    â”‚               â”‚             â”‚             â”‚
    â”‚ POST /api/tasks    â”‚               â”‚             â”‚             â”‚
    â”‚ Bearer: <token>    â”‚               â”‚             â”‚             â”‚
    â”‚ {title, priority}  â”‚               â”‚             â”‚             â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚             â”‚             â”‚
    â”‚                    â”‚               â”‚             â”‚             â”‚
    â”‚                    â”‚ get_current_user()          â”‚             â”‚
    â”‚                    â”‚ (Dependency)  â”‚             â”‚             â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚             â”‚
    â”‚                    â”‚               â”‚             â”‚             â”‚
    â”‚                    â”‚               â”‚ Decode JWT  â”‚             â”‚
    â”‚                    â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚             â”‚
    â”‚                    â”‚               â”‚        â”‚    â”‚             â”‚
    â”‚                    â”‚               â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚             â”‚
    â”‚                    â”‚               â”‚             â”‚             â”‚
    â”‚                    â”‚               â”‚ Get user    â”‚             â”‚
    â”‚                    â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚               â”‚             â”‚   Query     â”‚
    â”‚                    â”‚               â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                    â”‚               â”‚  User       â”‚             â”‚
    â”‚                    â”‚               â”‚             â”‚             â”‚
    â”‚  âŒ 401 Error      â”‚               â”‚             â”‚             â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚             â”‚
    â”‚  if token invalid  â”‚               â”‚  None       â”‚             â”‚
    â”‚                    â”‚               â”‚             â”‚             â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚             â”‚
    â”‚                    â”‚  current_user â”‚             â”‚             â”‚
    â”‚                    â”‚               â”‚             â”‚             â”‚
    â”‚                    â”‚ Validate TaskCreate         â”‚             â”‚
    â”‚                    â”‚ (Pydantic)    â”‚             â”‚             â”‚
    â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚             â”‚             â”‚
    â”‚                    â”‚            â”‚  â”‚             â”‚             â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚             â”‚             â”‚
    â”‚                    â”‚               â”‚             â”‚             â”‚
    â”‚                    â”‚ create_task() â”‚             â”‚             â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚
    â”‚                    â”‚               â”‚             â”‚             â”‚
    â”‚                    â”‚               â”‚             â”‚ INSERT Task â”‚
    â”‚                    â”‚               â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚               â”‚             â”‚             â”‚
    â”‚                    â”‚               â”‚             â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                    â”‚               â”‚             â”‚  new_task   â”‚
    â”‚                    â”‚               â”‚             â”‚             â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
    â”‚                    â”‚  Task object  â”‚             â”‚             â”‚
    â”‚                    â”‚               â”‚             â”‚             â”‚
    â”‚  âœ… 201 Created    â”‚               â”‚             â”‚             â”‚
    â”‚  {id, title,       â”‚               â”‚             â”‚             â”‚
    â”‚   status, ...}     â”‚               â”‚             â”‚             â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚             â”‚             â”‚
    â”‚                    â”‚               â”‚             â”‚             â”‚
```

---

## ğŸ“Š 4. Flujo de Listar Tareas con Filtros (RF8, RF9, RF13)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client â”‚          â”‚ FastAPI  â”‚         â”‚ crud â”‚         â”‚ Database â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”¬â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚ GET /api/tasks?    â”‚                   â”‚                  â”‚
    â”‚  status=pending&   â”‚                   â”‚                  â”‚
    â”‚  order_by=priority â”‚                   â”‚                  â”‚
    â”‚ Bearer: <token>    â”‚                   â”‚                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚ [Authenticate]    â”‚                  â”‚
    â”‚                    â”‚ get_current_user()â”‚                  â”‚
    â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                  â”‚
    â”‚                    â”‚           â”‚       â”‚                  â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                  â”‚
    â”‚                    â”‚  current_user     â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚ Validate params   â”‚                  â”‚
    â”‚                    â”‚ (status, order_by)â”‚                  â”‚
    â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                  â”‚
    â”‚                    â”‚           â”‚       â”‚                  â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚ get_tasks()       â”‚                  â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
    â”‚                    â”‚  user_id,         â”‚                  â”‚
    â”‚                    â”‚  status="pending",â”‚                  â”‚
    â”‚                    â”‚  order_by="priority"                 â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚ SELECT * FROM    â”‚
    â”‚                    â”‚                   â”‚  tasks           â”‚
    â”‚                    â”‚                   â”‚ WHERE user_id=?  â”‚
    â”‚                    â”‚                   â”‚  AND status='pending'
    â”‚                    â”‚                   â”‚ ORDER BY priorityâ”‚
    â”‚                    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                    â”‚                   â”‚  [Task1, Task2]  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚ get_task_statistics()
    â”‚                    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚                   â”‚  COUNT queries   â”‚
    â”‚                    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                    â”‚                   â”‚  {total, pending,â”‚
    â”‚                    â”‚                   â”‚   completed}     â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
    â”‚                    â”‚  tasks + stats    â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚  âœ… 200 OK         â”‚                   â”‚                  â”‚
    â”‚  {tasks: [...],    â”‚                   â”‚                  â”‚
    â”‚   total: 10,       â”‚                   â”‚                  â”‚
    â”‚   pending: 6,      â”‚                   â”‚                  â”‚
    â”‚   completed: 4}    â”‚                   â”‚                  â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
```

---

## âœ… 5. Flujo de Marcar Tarea como Completada (RF6)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client â”‚          â”‚ FastAPI  â”‚         â”‚ crud â”‚         â”‚ Database â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”¬â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚ POST /api/tasks/   â”‚                   â”‚                  â”‚
    â”‚   {id}/complete    â”‚                   â”‚                  â”‚
    â”‚ Bearer: <token>    â”‚                   â”‚                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚ [Authenticate]    â”‚                  â”‚
    â”‚                    â”‚ get_current_user()â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚ mark_task_completed()                â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
    â”‚                    â”‚  task_id, user_id â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚ SELECT task      â”‚
    â”‚                    â”‚                   â”‚ WHERE id=? AND   â”‚
    â”‚                    â”‚                   â”‚  user_id=?       â”‚
    â”‚                    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚  âŒ 404 Not Found  â”‚                   â”‚                  â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
    â”‚  if not found      â”‚                   â”‚  None            â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                    â”‚                   â”‚  Task object     â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚ UPDATE tasks     â”‚
    â”‚                    â”‚                   â”‚ SET status=      â”‚
    â”‚                    â”‚                   â”‚  'completed',    â”‚
    â”‚                    â”‚                   â”‚  updated_at=NOW  â”‚
    â”‚                    â”‚                   â”‚ WHERE id=?       â”‚
    â”‚                    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                    â”‚                   â”‚  Success         â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
    â”‚                    â”‚  updated_task     â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚  âœ… 200 OK         â”‚                   â”‚                  â”‚
    â”‚  {id, status:      â”‚                   â”‚                  â”‚
    â”‚   "completed", ...}â”‚                   â”‚                  â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
```

---

## â° 6. Flujo de Crear Recordatorio (RF11)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client â”‚          â”‚ FastAPI  â”‚         â”‚ crud â”‚         â”‚ Database â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”¬â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚ POST /api/remindersâ”‚                   â”‚                  â”‚
    â”‚ {task_id,          â”‚                   â”‚                  â”‚
    â”‚  remind_at}        â”‚                   â”‚                  â”‚
    â”‚ Bearer: <token>    â”‚                   â”‚                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚ [Authenticate]    â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚ Validate schema   â”‚                  â”‚
    â”‚                    â”‚ (ReminderCreate)  â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚ create_reminder() â”‚                  â”‚
    â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
    â”‚                    â”‚  reminder, user_idâ”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚ Verify task      â”‚
    â”‚                    â”‚                   â”‚ exists & belongs â”‚
    â”‚                    â”‚                   â”‚ to user          â”‚
    â”‚                    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚                   â”‚  SELECT task     â”‚
    â”‚                    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                    â”‚                   â”‚  Task or None    â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚  âŒ 404 Error      â”‚                   â”‚                  â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
    â”‚  if task not found â”‚                   â”‚  None            â”‚
    â”‚  or not owned      â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚ INSERT Reminder  â”‚
    â”‚                    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                    â”‚                   â”‚  new_reminder    â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
    â”‚                    â”‚  Reminder object  â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
    â”‚  âœ… 201 Created    â”‚                   â”‚                  â”‚
    â”‚  {id, task_id,     â”‚                   â”‚                  â”‚
    â”‚   remind_at,       â”‚                   â”‚                  â”‚
    â”‚   is_sent: false}  â”‚                   â”‚                  â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚                  â”‚
    â”‚                    â”‚                   â”‚                  â”‚
```

---

## ğŸ” 7. Flujo de BÃºsqueda por Palabras Clave (RF13)

```
Cliente envÃ­a: GET /api/tasks?search=FastAPI

1. AutenticaciÃ³n (get_current_user)
   â†“
2. get_tasks(db, user_id, search="FastAPI")
   â†“
3. Query SQL:
   SELECT * FROM tasks
   WHERE user_id = ?
     AND (title LIKE '%FastAPI%' 
          OR description LIKE '%FastAPI%')
   ORDER BY created_at DESC
   â†“
4. Retornar tareas que contienen "FastAPI"
```

---

## ğŸ“ˆ 8. Flujo de EstadÃ­sticas (RF14)

```
Cliente envÃ­a: GET /api/tasks

1. AutenticaciÃ³n
   â†“
2. get_tasks() â†’ retorna lista de tareas
   â†“
3. get_task_statistics(db, user_id)
   â†“
   SELECT COUNT(*) FROM tasks WHERE user_id = ?
   â†’ total
   
   SELECT COUNT(*) FROM tasks 
   WHERE user_id = ? AND status = 'completed'
   â†’ completed
   
   pending = total - completed
   â†“
4. Retornar JSON:
   {
     "tasks": [...],
     "total": 10,
     "completed": 3,
     "pending": 7
   }
```

---

## ğŸ”„ 9. Ciclo de vida de una peticiÃ³n autenticada

```
1. Client Request
   â†“
   Headers: Authorization: Bearer <JWT>
   
2. FastAPI Router
   â†“
   Dependency: get_current_user()
   
3. HTTPBearer extracts token
   â†“
   Token validation (decode JWT)
   
4. Query database for user
   â†“
   User exists?
   
   âŒ No â†’ 401 Unauthorized
   âœ… Yes â†’ Continue
   
5. Execute endpoint logic
   â†“
   CRUD operations
   
6. Return response
   â†“
   JSON serialization (Pydantic)
   
7. Client receives response
```

---

## ğŸ›¡ï¸ 10. ValidaciÃ³n de Ownership (Seguridad)

```
Ejemplo: Actualizar tarea

1. Cliente envÃ­a:
   PUT /api/tasks/task-123
   Bearer: token_de_usuario_A

2. get_current_user()
   â†’ User A (id: user-A)

3. update_task(db, task_id="task-123", user_id="user-A")
   â†“
4. get_task_by_id(db, "task-123", "user-A")
   â†“
   Query:
   SELECT * FROM tasks
   WHERE id = 'task-123'
     AND user_id = 'user-A'  â† ValidaciÃ³n de ownership
   
   Si la tarea pertenece a otro usuario:
   â†’ None â†’ 404 Not Found
   
   Si la tarea pertenece al usuario:
   â†’ Task object â†’ Permitir actualizaciÃ³n
```

**Esto previene que usuarios accedan a tareas de otros usuarios.**

---

## ğŸ” 11. GeneraciÃ³n y validaciÃ³n de JWT

```
=== LOGIN (GeneraciÃ³n de JWT) ===

1. Usuario envÃ­a email + password
   â†“
2. Verificar credenciales
   â†“
3. create_access_token({"sub": user_id})
   â†“
4. JWT Structure:
   
   Header:
   {
     "alg": "HS256",
     "typ": "JWT"
   }
   
   Payload:
   {
     "sub": "user-abc-123",  â† user_id
     "exp": 1730000000       â† expiration timestamp
   }
   
   Signature:
   HMACSHA256(
     base64UrlEncode(header) + "." +
     base64UrlEncode(payload),
     SECRET_KEY
   )
   â†“
5. Return token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWI..."

=== REQUEST AUTENTICADO (ValidaciÃ³n) ===

1. Cliente envÃ­a:
   Authorization: Bearer eyJhbGc...
   â†“
2. decode_access_token(token)
   â†“
   â€¢ Verificar firma (HMAC con SECRET_KEY)
   â€¢ Verificar expiraciÃ³n (exp claim)
   â€¢ Extraer user_id (sub claim)
   â†“
   Valid? â†’ user_id
   Invalid? â†’ None â†’ 401 Unauthorized
```

---

**Diagramas de flujo del backend QuickTask v1.0**  
**Todos los flujos implementados y funcionando âœ…**
